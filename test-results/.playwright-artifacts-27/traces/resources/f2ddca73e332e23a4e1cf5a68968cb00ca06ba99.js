!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var n="object"==typeof exports?t(require("react")):t(e.react);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(e){return function(e){function t(t){for(var n,a,o=t[0],c=t[1],i=0,u=[];i<o.length;i++)a=o[i],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&u.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);u.length;)u.shift()()}var n={},r={0:0};function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=o);var c,i=document.createElement("script");i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=function(e){return a.p+"widgets/SprintrFeedbackWidget/"+e+".SprintrFeedback.js"}(e);var l=new Error;c=function(t){i.onerror=i.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",l.name="ChunkLoadError",l.type=a,l.request=o,n[1](l)}r[e]=void 0}};var u=setTimeout((function(){c({type:"timeout",target:i})}),12e4);i.onerror=i.onload=c,document.head.appendChild(i)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var i=0;i<o.length;i++)t(o[i]);var l=c;return a(a.s=6)}([function(t,n){t.exports=e},function(e,t,n){var r;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)){if(r.length){var c=a.apply(null,r);c&&e.push(c)}}else if("object"===o)if(r.toString===Object.prototype.toString)for(var i in r)n.call(r,i)&&r[i]&&e.push(i);else e.push(r.toString())}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){"use strict";var r=n(4);function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new a("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new a("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=a},function(e){e.exports=JSON.parse('{"a":"10.1.0"}')},function(e,t,n){var r=n(5);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return r(t)}}},function(e,t){function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,a,o=0,c=0,i="";a=t.charAt(c++);~a&&(r=o%4?64*r+a:a,o++%4)?i+=String.fromCharCode(255&r>>(-2*o&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return i}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Re}));var r,a=n(0);!function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.SERVER_ERROR=500]="SERVER_ERROR"}(r||(r={}));var o,c,i;!function(e){e[e.Freehand=0]="Freehand"}(o||(o={})),function(e){e.MidnightBlue="#2f3646",e.Grey="#c1c3c8",e.Green="#4fd84f",e.Blue="#47a9ff",e.Purple="#845eff",e.Magenta="#ca49f8",e.Red="#fb4a4c",e.Yellow="#fcc73a"}(c||(c={})),function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six"}(i||(i={}));var l=function(e){var t=e.screenshot,n=e.imageSize,r=e.setImageSize,o=e.setCursorPosition,c=e.imageCanvasRef,i=e.freehandCanvasRef,l=Object(a.useRef)(null),u=function(){c.current&&o({top:c.current.offsetTop,left:c.current.offsetLeft})};Object(a.useEffect)((function(){if(l.current&&c.current&&n){var e=c.current.getContext("2d");if(!e)return;e.drawImage(l.current,0,0,n.width,n.height),u()}}),[n]);var s=function(){if(l.current)if(l.current.width>.8*window.innerWidth){var e=.8*window.innerWidth/l.current.width;r({width:l.current.width*e,height:l.current.height*e})}else r({width:l.current.width,height:l.current.height})};return Object(a.useEffect)((function(){if(l.current&&c.current)return u(),c.current.addEventListener("resize",u),function(){c.current&&c.current.removeEventListener("resize",u)}}),[l.current,c.current]),Object(a.useEffect)((function(){return window.addEventListener("resize",s),function(){window.removeEventListener("resize",s)}}),[]),Object(a.createElement)("div",{className:"mxfeedback-annotation-canvas"},Object(a.createElement)("img",{ref:l,src:t,className:"hidden",onLoad:s}),Object(a.createElement)("canvas",{className:"mxfeedback-annotation-canvas__canvas",ref:c,width:n?n.width:void 0,height:n?n.height:void 0}),Object(a.createElement)("canvas",{className:"mxfeedback-annotation-canvas__canvas",ref:i,width:n?n.width:void 0,height:n?n.height:void 0}))},u=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg"},Object(a.createElement)("path",{d:"M3.9907 6.6554C3.77013 6.65566 3.56013 6.56093 3.41437 6.39536L0.144042 2.67803C-0.070925 2.42186 -0.0420586 2.0409 0.209075 1.82C0.460207 1.59913 0.84174 1.61913 1.06837 1.86503L3.92803 5.1157C3.94387 5.13376 3.9667 5.14413 3.9907 5.14413C4.01473 5.14413 4.03757 5.13376 4.05337 5.1157L6.91307 1.86503C7.13973 1.61913 7.52123 1.59913 7.77237 1.82C8.0235 2.0409 8.05237 2.42186 7.8374 2.67803L4.56803 6.39403C4.42203 6.56 4.21173 6.65516 3.9907 6.6554Z"}))},s=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,viewBox:"0 0 10 10",fill:"none",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Object(a.createElement)("path",{d:"M8.5 1L3.46933 8.18633C3.33468 8.37982 3.11523 8.49678 2.87953 8.50068C2.64384 8.50457 2.42064 8.39493 2.27967 8.206L1 6.5",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},d=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("rect",{x:"12",y:"14",width:"2",height:"10"}),Object(a.createElement)("rect",{x:"18",y:"14",width:"2",height:"10"}),Object(a.createElement)("rect",{x:"13",y:"3",width:"6",height:"2"}),Object(a.createElement)("path",{d:"M8,7h-3v2h2V27c0,1.1,.85,2,1.89,2h14.22c1.04,0,1.89-.9,1.89-2V9h2v-2H8Zm14.99,20H9V9h14V27Z"}))},f=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M20,28H4V6h13v-2H4c-1.1,0-2,.9-2,2V28c0,1.1,.9,2,2,2H20c1.1,0,2-.9,2-2v-10h-2v10Z"}),Object(a.createElement)("path",{d:"M28.24,6.78l.03-.32c.15-1.54-.17-2.71-.95-3.49-.77-.77-1.94-1.09-3.48-.94l-.36,.04L12.09,13.48l-1.42,6.17,6.2-1.42,9.98-10.01,1.15,1.15-4.24,4.24,1.41,1.41,4.24-4.24c.38-.38,.59-.88,.59-1.41s-.21-1.04-.59-1.41l-1.17-1.17Zm-3.85-2.77c.56-.02,1.19,.05,1.53,.39,.34,.34,.41,.97,.39,1.53l-3.26,3.27-1.92-1.92,3.27-3.27Zm-8.53,12.4l-2.53,.58,.58-2.5,5.8-5.8,1.92,1.92-5.77,5.79Z"}))},m=n(1),b=n.n(m),p=[{name:"midnight",color:c.MidnightBlue},{name:"grey",color:c.Grey},{name:"green",color:c.Green},{name:"blue",color:c.Blue},{name:"purple",color:c.Purple},{name:"magenta",color:c.Magenta},{name:"red",color:c.Red},{name:"yellow",color:c.Yellow}],h=[{name:"one",width:i.One},{name:"two",width:i.Two},{name:"three",width:i.Three},{name:"four",width:i.Four},{name:"five",width:i.Five},{name:"six",width:i.Six}],v=function(e){var t=e.colorName,n=e.colorHex,r=e.setMethod,o=e.selected,c=e.freehandToolRef,i=e.tabIndex;return Object(a.createElement)("button",{className:b()("mxfeedback-tool-button__color","mxfeedback-tool-button__color--"+t),onClick:function(){var e;r(n),null===(e=c.current)||void 0===e||e.focus()},tabIndex:i},o&&Object(a.createElement)(s,null))},g=function(e){var t=e.thicknessName,n=e.width,r=e.setMethod,o=e.selected,c=e.freehandToolRef,i=e.tabIndex;return Object(a.createElement)("button",{className:b()("mxfeedback-button","mxfeedback-tool-button__thickness","mxfeedback-tool-button__thickness--"+t,o?"mxfeedback-tool-button__thickness--selected":""),onClick:function(){var e;r(n),null===(e=c.current)||void 0===e||e.focus()},tabIndex:i})},k=function(e){var t=e.menuRef,n=e.freehandToolRef,r=e.currentTool,c=e.setFreehandTool,i=e.currentColor,l=e.setCurrentColor,s=e.currentThickness,m=e.setCurrentThickness,k=e.onClearClicked,_=e.onSaveClicked,w=e.onCancel,x=e.translation,E=Object(a.useState)(!1),O=E[0],y=E[1],j=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=function(e){O&&j.current&&!j.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[O]),Object(a.createElement)("div",{className:"mxfeedback-toolbar mxfeedback-toolbar--gap-lg mxfeedback-toolbar--annotation","data-html2canvas-ignore":"true",ref:t},Object(a.createElement)("div",{className:"mxfeedback-button-group mxfeedback-button-group--gap-md"},Object(a.createElement)("button",{className:b()("mxfeedback-tool-button",r===o.Freehand&&"mxfeedback-tool-button--active"),onClick:function(){y(!O),r!==o.Freehand&&c()},ref:n,autoFocus:!0,tabIndex:0},Object(a.createElement)("div",{className:"mxfeedback-tool-button__inner"},Object(a.createElement)(f,{className:"mxfeedback-tool-button__icon"}),Object(a.createElement)("span",{className:"mxfeedback-tool-button__label"},"Annotate")),Object(a.createElement)("div",{className:"mxfeedback-tool-button__dropdown"},Object(a.createElement)(u,{className:"mxfeedback-tool-button__caret"}),O&&Object(a.createElement)("div",{ref:j,className:"mxfeedback-tool-button__menu"},Object(a.createElement)("div",{className:"mxfeedback-tool-button__list"},p.map((function(e){return Object(a.createElement)(v,{key:e.name,colorName:e.name,colorHex:e.color,setMethod:l,selected:i===e.color,freehandToolRef:n,tabIndex:0})}))),Object(a.createElement)("div",{className:"mxfeedback-tool-button__list mxfeedback-tool-button__list--col-3"},h.map((function(e){return Object(a.createElement)(g,{key:e.name,thicknessName:e.name,setMethod:m,width:e.width,selected:s===e.width,freehandToolRef:n,tabIndex:0})})))))),Object(a.createElement)("button",{className:"mxfeedback-tool-button",onClick:k,tabIndex:0},Object(a.createElement)("div",{className:"mxfeedback-tool-button__inner"},Object(a.createElement)(d,{className:"mxfeedback-tool-button__icon"}),Object(a.createElement)("span",{className:"mxfeedback-tool-button__label"},"Clear")))),Object(a.createElement)("div",{className:"mxfeedback-button-group"},Object(a.createElement)("button",{className:b()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text","mxfeedback-toolbar__cancel-screenshot-button"),type:"button",onClick:w,"data-testid":"cancel-screenshot",tabIndex:0},x.Cancel),Object(a.createElement)("button",{className:b()("btn mx-button btn-primary","mxfeedback-toolbar__save-screenshot-button mxfeedback-button"),type:"button",onClick:_,"data-testid":"save-screenshot",tabIndex:0},x.Done)))},_=function(e,t,n,r){var a;if(e&&t){var o=e.getContext("2d");if(o){e.onmousedown=function(a){if(e){var c=t.left,i=t.top;o.beginPath(),o.lineWidth=n,o.strokeStyle=r,o.lineJoin="round",o.lineCap="round",o.moveTo(a.clientX-c,a.clientY-i),e.onmouseup=function(){e&&(e.onmousemove=null,e.onmouseup=null,o.closePath())},e.onmousemove=function(e){var n=t.left,r=t.top;o.lineTo(e.clientX-n,e.clientY-r),o.stroke()}}};var c=function(e){var n=e.changedTouches;if(a&&0!==n.length){var r=t.left,c=t.top;o.beginPath(),o.moveTo(a.pageX-r,a.pageY-c),o.lineTo(n[0].pageX-r,n[0].pageY-c),o.stroke(),a=n[0]}},i=function(){e&&(e.removeEventListener("touchend",i),e.removeEventListener("touchmove",c),o.closePath())},l=function(t){e.onmousemove=null,e.onmouseup=null;var l=t.changedTouches;0!==l.length&&(a=l[0],o.beginPath(),o.lineWidth=n,o.strokeStyle=r,o.lineJoin="round",o.lineCap="round",e.addEventListener("touchend",i),e.addEventListener("touchmove",c,{passive:!0}))};e.addEventListener("touchstart",l,{passive:!0});return function(){e.removeEventListener("touchstart",l),e.removeEventListener("touchmove",c),e.removeEventListener("touchend",i)}}}},w=function(e){var t,n=e.screenshot,r=e.onSave,u=e.onCancel,s=e.translation,d=Object(a.useRef)(null),f=Object(a.useRef)(null),m=Object(a.useRef)(null),b=Object(a.useRef)(null),p=Object(a.useState)(),h=p[0],v=p[1],g=Object(a.useState)(),w=g[0],x=g[1],E=Object(a.useState)(o.Freehand),O=E[0],y=E[1],j=Object(a.useState)(c.Yellow),S=j[0],N=j[1],T=Object(a.useState)(i.Three),R=T[0],C=T[1],L=Object(a.useRef)(null),F=Object(a.useRef)(null),I=Object(a.useRef)(null);Object(a.useEffect)((function(){return m.current&&w&&(t&&t(),t=_(m.current,w,R,S)),function(){t&&t()}}),[S,R,w]);var A=function(e){var t,n;"Escape"===e.key&&u(),"Tab"===e.key&&(e.target!==I.current||e.shiftKey?e.target===F.current&&e.shiftKey&&(null===(n=I.current)||void 0===n||n.focus()):(e.preventDefault(),null===(t=F.current)||void 0===t||t.focus()))};return Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=L.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);F.current=n[0],I.current=n[n.length-1],F.current.focus()}),[F,I]),Object(a.useEffect)((function(){return document.addEventListener("keydown",A),function(){document.removeEventListener("keydown",A)}}),[]),Object(a.createElement)("div",{ref:L,className:"mxfeedback-annotation-frame"},Object(a.createElement)(k,{menuRef:d,freehandToolRef:f,currentTool:O,setFreehandTool:function(){y(o.Freehand),m.current&&_(m.current,w,R,S)},currentColor:S,setCurrentColor:N,currentThickness:R,setCurrentThickness:C,onClearClicked:function(){if(m.current){var e=m.current.getContext("2d");e&&e.clearRect(0,0,m.current.width,m.current.height)}},onSaveClicked:function(){if(b.current){var e=b.current.getContext("2d");e&&(m.current&&e.drawImage(m.current,0,0),r(b.current.toDataURL()))}},onCancel:u,translation:s}),Object(a.createElement)(l,{screenshot:n,imageSize:h,setImageSize:v,setCursorPosition:x,imageCanvasRef:b,freehandCanvasRef:m}))},x=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("polygon",{points:"27.71 5.71 26.29 4.29 16 14.59 5.71 4.29 4.29 5.71 14.59 16 4.29 26.29 5.71 27.71 16 17.41 26.29 27.71 27.71 26.29 17.41 16 27.71 5.71"}))},E=b()("mxfeedback-failed","mxfeedback-failed__open"),O=function(e){var t=e.error,n=e.onCloseResult,r=e.translation,o=e.widgetSettings,c=Object(a.useRef)(null),i=Object(a.useRef)(null);console.error("Feedback Widget >> "+t);var l=function(e){var t,r;"Enter"!==e.key&&"Escape"!==e.key||n(),"Tab"===e.key&&(e.shiftKey?e.target===c.current&&(e.preventDefault(),null===(t=i.current)||void 0===t||t.focus()):e.target===i.current&&(e.preventDefault(),null===(r=c.current)||void 0===r||r.focus()))};return Object(a.useEffect)((function(){return document.addEventListener("keydown",l),function(){document.removeEventListener("keydown",l)}}),[]),Object(a.createElement)("div",{className:b()(E,"mxfeedback-dialog")},Object(a.createElement)("button",{ref:c,className:"mxfeedback-close-button",onClick:n,"aria-label":"Close button"},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("span",{className:"mxfeedback-dialog__title"},r.Submit_Feedback_Error_Title),Object(a.createElement)("span",{className:"mxfeedback-failed__message"},r.Submit_Feedback_Error_Message),o.submitFailedImgUrl&&Object(a.createElement)("img",{src:o.submitFailedImgUrl,alt:"failed image",className:"mxfeedback-failed__error-image"}),Object(a.createElement)("div",{className:"mxfeedback-button-group spacing-outer-top-medium"},Object(a.createElement)("button",{ref:i,className:b()("btn btn-primary","mxfeedback-failed__close-button mxfeedback-button"),form:"comment",type:"button",onClick:n,"aria-label":"Close failed button",autoFocus:!0},r.Close)))},y=function(e){return!e||!(e.length>128e3)},j=function(e){if(!e||!e.trim())return!1;if(e.length>200)return!1;return/[a-z0-9]/.test(e.toLowerCase())},S=function(e){if(!e)return!1;return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())},N=function(e){if(e&&0!==e.length)if("image"===e[0].type.split("/")[0]){if(!(e[0].size>5242880))return e[0];console.error("Feedback Widget >> Image is too big")}else console.error("Feedback Widget >> File is not an image");else console.error("Feedback Widget >> No file selected")},T=function(e){var t=e.className,n=void 0===t?"":t,r=e.onClick;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",onClick:r},Object(a.createElement)("g",{strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.6"},Object(a.createElement)("path",{d:"M5 8h6"}),Object(a.createElement)("path",{d:"M8 15.5a7.5 7.5 0 100-15 7.5 7.5 0 000 15z"}),Object(a.createElement)("path",{d:"M5.879 10.121L10.12 5.88M10.121 10.121L5.878 5.88"})))},R=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M16,2c-7.72,0-14,6.28-14,14s6.28,14,14,14,14-6.28,14-14S23.72,2,16,2Zm0,26c-6.62,0-12-5.38-12-12S9.38,4,16,4s12,5.38,12,12-5.38,12-12,12Z"}),Object(a.createElement)("polygon",{points:"17 13 12 13 12 15 15 15 15 22 12 22 12 24 20 24 20 22 17 22 17 13"}),Object(a.createElement)("circle",{cx:"16",cy:"9.5",r:"1.5"}))},C=function(e){var t=e.tip;return Object(a.createElement)("div",{className:"mxfeedback-tooltip"},Object(a.createElement)(R,{className:"mxfeedback-tooltip__icon"}),Object(a.createElement)("p",{className:"mxfeedback-tooltip__tip"},t))},L=function(e){var t=e.children,n=e.id,r=e.errorText,o=e.labelText,c=e.hasError,i=e.className,l=void 0===i?"":i,u=e.tooltipText,s=void 0===u?"":u;return Object(a.createElement)("div",{className:b()("form-group no-columns","mxfeedback-form-group",l,c&&"has-error"),"aria-label":"Feedback "+o},Object(a.createElement)("div",{className:"mxfeedback-label-group"},Object(a.createElement)("label",{className:"control-label mxfeedback-label-group__label",id:n+"_label"},o),s&&Object(a.createElement)(C,{tip:s})),t,c&&Object(a.createElement)("div",{className:"alert alert-danger mx-validation-message",role:"alert"},r))},F=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M28.71,27.29l-6.97-6.97c1.41-1.72,2.26-3.93,2.26-6.32,0-5.51-4.49-10-10-10S4,8.49,4,14s4.49,10,10,10c2.4,0,4.6-.85,6.32-2.26l6.97,6.97,1.41-1.41Zm-14.71-5.29c-4.41,0-8-3.59-8-8S9.59,6,14,6s8,3.59,8,8-3.59,8-8,8Z"}))},I=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M28,8h-5.22l-.62-2.48c-.22-.89-1.02-1.52-1.94-1.52H11.78c-.92,0-1.72,.62-1.94,1.52l-.62,2.48H4c-1.1,0-2,.9-2,2V26c0,1.1,.9,2,2,2H28c1.1,0,2-.9,2-2V10c0-1.1-.9-2-2-2Zm0,18H4V10h6.78l1-4h8.44l1,4h6.78V26Z"}),Object(a.createElement)("path",{d:"M16,12c-3.31,0-6,2.69-6,6s2.64,6,6,6,6-2.69,6-6-2.75-6-6-6Zm0,10c-2.24,0-4-1.76-4-4s1.79-4,4-4,4,1.87,4,4-1.79,4-4,4Z"}))},A=function(e){var t=e.className,n=void 0===t?"":t;return Object(a.createElement)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Object(a.createElement)("path",{d:"M26,26H6v-4h-2v4c0,1.1,.9,2,2,2H26c1.1,0,2-.9,2-2v-4h-2v4Z"}),Object(a.createElement)("polygon",{points:"15 7.41 15 22 17 22 17 7.41 22.29 12.71 23.71 11.29 16 3.59 8.29 11.29 9.71 12.71 15 7.41"}))},U=Object(a.forwardRef)((function(e,t){var n=e.takeScreenshot,r=e.translation,o=e.uploadScreenshot,c=Object(a.useRef)(null),i=Object(a.useRef)(null);return Object(a.createElement)("div",{className:b()("mxfeedback-button-group mxfeedback-screenshot-button-group","mxfeedback-button-group--justify-center mxfeedback-button-group--row-xs")},Object(a.createElement)("button",{className:b()("btn mx-button btn-primary mxfeedback-button","mxfeedback-button","mxfeedback-feedback-form__screenshot-button"),id:"mxfeedback_feedback_take_screenshot_button",ref:t,type:"button",onClick:n,"data-testid":"enter-screenshot-mode",tabIndex:0},Object(a.createElement)(I,null),r.Enter_screenshot_mode),Object(a.createElement)("input",{ref:c,type:"file",onChange:o,accept:".gif,.jpg,.jpeg,.png",className:"hidden"}),Object(a.createElement)("button",{tabIndex:0,className:b()("btn mx-button","mxfeedback-button","mxfeedback-feedback-form__upload-button"),id:"mxfeedback_feedback_upload_screenshot_button",ref:i,onClick:function(){var e;return c&&(null===(e=c.current)||void 0===e?void 0:e.click())},name:"feedback_attachment","data-testid":"upload-from-computer"},Object(a.createElement)(A,null),r.Upload_from_computer))})),M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},D=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};function H(e){return new Promise((function(t,n){window.mx.data.action({params:e,callback:function(e){var n=e;if(e instanceof Array&&e.length){var r=e[0];n=r.getAttributes().reduce((function(e,t){var n;return M(M({},e),((n={})[t]=r.get(t),n))}),{})}t(n)},error:n})}))}function V(e){return new Promise((function(t,n){if(!e)return null;window.mx.data.get(M(M({},e),{callback:t,error:n}))}))}var B,z=window.mx.session,Z=function(e){return H({actionname:e})},W=function(){return z.getUserId&&z.getUserId()},Y=function(){return z.getUserName?z.getUserName():""},q=function(){return z.getUserRoleNames?z.getUserRoleNames():[]},G=function(){return z.isGuest&&z.isGuest()},K=function(){var e=window.mx.ui;try{return void 0!==e&&"function"==typeof e.getContentForm&&void 0!==e.getContentForm().path?e.getContentForm():void 0}catch(e){return}},J=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},X=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},Q=function(e,t,n){var r,a=function(e,t){var n,r=e.getGuid(),a=r&&0!==Number(r);return t&&e.has(t)?e.get(t):(n=!G(),a&&n?Y():"")}(e,t);return{name:a,email:e&&n&&e.has(n)?e.get(n):(r=a)&&r.match(/.+@.+\..+/)?r:"",userRoles:q()}},$=function(e,t){return J(void 0,void 0,void 0,(function(){var n;return X(this,(function(r){switch(r.label){case 0:return[4,P(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,V({guid:W()})];case 1:return[2,e.sent()]}}))}))];case 1:return[2,(n=r.sent())?Q(n,e,t):{name:"",email:"",userRoles:[]}]}}))}))},ee=n(2),te=n.n(ee),ne=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},re=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ae=function(e){var t=e.idToken,n=e.usernameAttribute,r=e.emailAttribute,a=e.decryptedTokenValue;return ne(void 0,void 0,void 0,(function(){var e,o,c,i,l,u,s,d,f;return re(this,(function(m){switch(m.label){case 0:return e=a||"Value",o="string"==typeof t?t:t[e],c=function(e){if(!e)return{displayName:"",email:""};var t=te()(e),n=t["mx:user:profile:v1"],r=n.display_name,a=n.email;return delete t["mx:user:profile:v1"],{displayName:r,email:a}}(o),i=c.displayName,l=c.email,[4,$(n,r)];case 1:return u=m.sent(),s=u.name,d=u.email,f=u.userRoles,[2,{name:i||s,email:l||d,userRoles:f}]}}))}))},oe=function(e,t,n,r,o){var c=Object(a.useState)(!1),i=c[0],l=c[1];Object(a.useEffect)((function(){if(e)""===e.email&&t(!0);else{if(i)return;l(!0),function(e){var t=e.idTokenProviderMf,n=e.decryptedTokenValue,r=e.userProviderMf,a=e.usernameAttribute,o=e.emailAttribute;return ne(void 0,void 0,void 0,(function(){var e,c,i,l,u,s,d,f;return re(this,(function(m){switch(m.label){case 0:return t?[4,Z(t)]:[3,2];case 1:if(e=m.sent())return[2,ae({idToken:e,usernameAttribute:a,emailAttribute:o,decryptedTokenValue:n})];m.label=2;case 2:return r?[4,Z(r)]:[3,5];case 3:return c=m.sent(),i=c&&c[a],l=c&&c[o],[4,$(a,o)];case 4:return u=m.sent(),s=u.name,d=u.email,f=u.userRoles,[2,{name:i||s,email:l||d,userRoles:f}];case 5:return[4,$(a,o)];case 6:return[2,m.sent()]}}))}))}(n).then((function(e){l(!1),r(e),e&&e.email?(t(!1),o(e)):t(!0)}))}}),[n])},ce=function(){return(ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ie=n(3),le=function(e,t,n,r,a,o,c,i,l,u,s,d,f,m,b){return function(p){var h=p.title,v=p.description,g=p.userData,k=u.sprintrapp,_=u.feedbackServerLocation,w=y(v);e(w);var x=j(h);t(x);var E=S(g.email);n(E),E||r||a(!0),x||!o.current?w||!c.current?E||!i.current?(l(!0),function(e){var t=e.sprintrapp,n=e.feedbackServerLocation,r=e.screenshot,a=e.userId,o=e.username,c=e.email,i=e.userRoles,l=e.title,u=e.description,s=r?r.replace(/(data:image\/png;base64,)/,""):"",d=K(),f={title:l,description:u,issueType:"Issue",submitter:{userId:a,email:c,displayName:o||c},metadata:{userRoles:i.join(","),location:window.location.href,form:d?d.path:"",userAgent:navigator.userAgent,screenWidth:window.screen.width,screenHeight:window.screen.height},imageAttachment:s};if(!f.submitter.userId){if(!f.submitter.displayName)return console.warn("Feedback Widget >> Username is empty"),Promise.reject(new Error("username is empty."));if(!f.submitter.email)return console.warn("Feedback Widget >> Email address is empty"),Promise.reject(new Error("email address is empty."))}return window.fetch(n+"rest/v3/feedbackapi/projects/"+t+"/issues",{method:"POST",body:JSON.stringify(f),headers:{"Content-Type":"application/json; charset=utf-8",ClientIdentifier:"Feedback Widget v"+ie.a}})}({sprintrapp:k,feedbackServerLocation:_,screenshot:u.allowScreenshot&&s?s:null,username:g?g.name:"",email:g?g.email:"",userRoles:g?g.userRoles:[],title:h,description:v}).then((function(e){e.ok?(d({title:"",description:"",email:"",screenshot:"",timestamp:""}),f(""),m()):(console.warn("Feedback Widget >> Failed submitting feedback with the following error: "+e.statusText),b(e.statusText)),l(!1)})).catch((function(e){console.warn("Feedback Widget >> Failed submitting feedback with the following error: "+e),l(!1),b(e)}))):i.current.focus():c.current.focus():o.current.focus()}},ue=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){r.result&&"string"==typeof r.result?t(r.result):n(new Error("Error reading file"))}}))},se=function(){return!(!window.navigator.clipboard||!window.navigator.clipboard.read)};!function(e){e[e.granted=0]="granted",e[e.prompt=1]="prompt",e[e.denied=2]="denied",e[e.notSupported=3]="notSupported"}(B||(B={}));var de,fe,me=function(){return(me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},be=function(e){var t=e.widgetSettings,n=e.formData,r=e.translation,o=e.updateFormData,c=e.onUpdateScreenshot,i=e.takeScreenshot,l=e.onShowLightbox,u=e.showLightbox,s=e.cancel,d=e.succeeded,f=e.failed,m=e.userInfoMFResult,p=e.setUserInfoMFResult,h=m||{name:"",email:n.email,userRoles:[]},v=Object(a.useState)(h),g=v[0],k=v[1],_=Object(a.useState)(!0),w=_[0],E=_[1],O=Object(a.useState)(!0),R=O[0],C=O[1],I=Object(a.useState)(!n||!n.email||S(n.email)),A=I[0],M=I[1],P=Object(a.useState)(!0),D=P[0],H=P[1],V=Object(a.useState)(!(t.userProviderMf||t.idTokenProviderMf||n&&n.email&&A)),B=V[0],z=V[1],Z=Object(a.useState)(!1),W=Z[0],Y=Z[1],q=Object(a.useRef)(null),G=Object(a.useRef)(null),K=Object(a.useRef)(null),J=Object(a.useRef)(null),X=Object(a.useRef)(null),Q=n.title,$=n.description,ee=n.email,te=n.screenshot,ne=Object(a.useRef)(null),re=Object(a.useRef)(null),ae=Object(a.useRef)(null),ie=function(e,t,n,r,a){return function(o){var c=o.target.value.trim(),i=S(c);i&&e(i),t(ce(ce({},n),{email:c})),r(ce(ce({},a),{email:c,timestamp:(new Date).toString()}))}}(M,k,g,o,n),se=function(e,t,n,r,a,o,c,i,l){return function(){e||!t.current?n||!r.current?a||!o.current?!c.current||i&&l||c.current.focus():o.current.focus():r.current.focus():t.current.focus()}}(Q,G,$,K,te,J,X,ee,A),de=function(e,t,n){return function(r){var a=e(r.target.files);a?(t(!0),ue(a).then(n).catch((function(e){return console.error(e)}))):t(!1)}}(N,H,c),fe=le(E,C,M,B,z,G,K,X,Y,t,te,o,c,d,f);oe(m,z,t,p,k);var be=function(e){var t,n;"Escape"===e.key&&(u?l(!1):s()),"Tab"===e.key&&(e.shiftKey?e.target===re.current&&(e.preventDefault(),null===(t=ae.current)||void 0===t||t.focus()):e.target===ae.current&&(e.preventDefault(),null===(n=re.current)||void 0===n||n.focus()))};Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=q.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);re.current=n[0],ae.current=n[n.length-1],re.current.focus()}),[re,ae]),Object(a.useEffect)((function(){return document.addEventListener("keydown",be),se(),function(){document.removeEventListener("keydown",be)}}),[]);return Object(a.createElement)("div",{className:b()("mxfeedback-feedback-form","mxfeedback-dialog"),"data-html2canvas-ignore":"true",ref:q},Object(a.createElement)("button",{className:"mxfeedback-close-button",onClick:s,"aria-label":"Close button",tabIndex:0},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("div",{className:"mxfeedback-dialog__header"},Object(a.createElement)("h4",{className:"mxfeedback-dialog__title"},"Share Feedback"),Object(a.createElement)("p",{className:"mxfeedback-dialog__body-text"},"Help us make your experience better and share your feedback with us!")),Object(a.createElement)(L,{id:"mxfeedback_feedback_title",errorText:"This Field is Required",labelText:r.Subject,hasError:!R,className:"mxfeedback__input-text"},Object(a.createElement)("input",{className:"form-control",id:"mxfeedback_feedback_title_input",ref:G,type:"text",value:Q,required:!0,name:"feedback_title",placeholder:"Summarize your feedback item in a few words",maxLength:200,onChange:function(e){var t=e.target.value,r=j(t);r&&C(r),o(me(me({},n),{title:t,timestamp:(new Date).toString()}))},onBlur:function(e){j(e.target.value)&&C(!0)},"aria-labelledby":"mxfeedback_feedback_title_label","data-testid":"title",autoFocus:!0,tabIndex:0})),Object(a.createElement)(L,{id:"mxfeedback_feedback_description",hasError:!w,labelText:r.Description,tooltipText:r.Add_as_many_details_as_you_can,errorText:"Comment is Invalid",className:"mxfeedback__input-textarea"},Object(a.createElement)("textarea",{className:"form-control mx-textarea-input mx-textarea-noresize",id:"mxfeedback_feedback_description_input",ref:K,value:$,name:"feedback_description",placeholder:"Please add a detailed description, including steps you took before finding the issue, or how this idea would help improve the experience for you and other users.",maxLength:128e3,rows:4,cols:50,onChange:function(e){E(y(e.target.value)),o(me(me({},n),{description:e.target.value,timestamp:(new Date).toString()}))},"aria-labelledby":"mxfeedback_feedback_description_label","data-testid":"description",tabIndex:0})),!!t.allowScreenshot&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(L,{id:"mxfeedback_feedback_take_screenshot",hasError:!D,labelText:r.Attachment,tooltipText:r.Use_Screenshot_mode_to_take_a_snapshot,errorText:"Maximum size is 5MB."},Object(a.createElement)(U,{takeScreenshot:i,translation:r,uploadScreenshot:de,ref:J})),te&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"mxfeedback-screenshot-preview"},Object(a.createElement)("img",{className:"mxfeedback-screenshot-preview__image",src:te,alt:"Feedback screenshot image"}),Object(a.createElement)("button",{onClick:function(){return l(!0)},className:"mxfeedback-screenshot-preview__overlay",id:"mxfeedback_feedback_preview_overlay",tabIndex:0},Object(a.createElement)(F,{className:"mxfeedback-screenshot-preview__preview-icon"})),Object(a.createElement)(T,{className:"mxfeedback-screenshot-preview__delete-icon",onClick:function(){o(me(me({},n),{screenshot:"",timestamp:(new Date).toString()}))}})))),B&&Object(a.createElement)(L,{id:"mxfeedback_feedback_email",hasError:!A,labelText:r.Email_Address,tooltipText:r.Your_email_address_is_optional,errorText:"Email is Invalid",className:"mxfeedback__input-text"},Object(a.createElement)("input",{className:"form-control",id:"mxfeedback_feedback_email_input",ref:X,type:"text",value:ee,name:"comment_email",placeholder:"name@company.com",maxLength:200,onChange:ie,onBlur:function(e){var t=S(n.email?n.email:e.target.value);t&&M(t)},"aria-labelledby":"mxfeedback_feedback_email_label","data-testid":"email",tabIndex:0})),Object(a.createElement)("div",{className:"mxfeedback-button-group"},Object(a.createElement)("button",{className:b()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text","mxfeedback-feedback-form__cancel-button"),type:"button",onClick:s,tabIndex:0},r.Cancel),Object(a.createElement)("button",{className:"btn mx-button btn-secondary mxfeedback-button mxfeedback__btn-bordered",type:"button",onClick:function(){o({title:"",description:"",email:"",screenshot:"",timestamp:""}),c("")},tabIndex:0},"Clear"),Object(a.createElement)("button",{className:"btn mx-button btn-primary mxfeedback-button",ref:ne,"data-testid":"submit",type:"button",disabled:W,onClick:function(){W||fe({title:Q,description:$,userData:g})},tabIndex:0},W?""+r.Sending_feedback:""+r.Submit)))},pe=b()("mxfeedback-result","mxfeedback-result__open"),he=function(e){var t=e.onCloseResult,n=e.translation,r=e.widgetSettings,o=Object(a.useRef)(null),c=Object(a.useRef)(null),i=function(e){var n,r;"Enter"!==e.key&&"Escape"!==e.key||t(),"Tab"===e.key&&(e.shiftKey?e.target===o.current&&(e.preventDefault(),null===(n=c.current)||void 0===n||n.focus()):e.target===c.current&&(e.preventDefault(),null===(r=o.current)||void 0===r||r.focus()))};return Object(a.useEffect)((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[]),Object(a.createElement)("div",{className:b()(pe,"mxfeedback-dialog")},Object(a.createElement)("button",{ref:o,className:"mxfeedback-close-button",onClick:t,"aria-label":"Close button"},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("span",{className:"mxfeedback-dialog__title"},n.Feedback_submitted),Object(a.createElement)("p",{className:"mxfeedback-dialog__body-text"},"Thanks for sharing your feedback with us!"),r.submitSuccessImgUrl&&Object(a.createElement)("img",{src:r.submitSuccessImgUrl,alt:"thank you image",className:"mxfeedback-result__result-image"}),Object(a.createElement)("div",{className:"mxfeedback-button-group spacing-outer-top-medium"},Object(a.createElement)("button",{ref:c,className:"btn mx-button btn-primary mxfeedback-button",form:"comment",type:"button",onClick:t,"aria-label":"Close result button",autoFocus:!0},n.Close)))},ve=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},ge=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},ke=function(){return ve(void 0,void 0,void 0,(function(){return ge(this,(function(e){return[2,new Promise((function(e,t){navigator.mediaDevices.getDisplayMedia({preferCurrentTab:!0}).then((function(n){(function(e){if("ImageCapture"in window){var t=e.getVideoTracks()[0],n=new ImageCapture(t);return new Promise((function(e,r){n.grabFrame().then((function(n){t.stop();var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var o=a.getContext("2d");o?(o.drawImage(n,0,0,n.width,n.height),a.toBlob((function(t){return t?e(t):r(new Error("No blob"))}),"image/png")):r("No context")})).catch((function(e){return r(e)}))}))}return new Promise((function(t,n){var r=document.createElement("video"),a=document.createElement("canvas"),o=a.getContext("2d");r.srcObject=e,r.addEventListener("loadeddata",(function(){var e=r.videoWidth,c=r.videoHeight;if(a.width=e,a.height=c,o)try{o.drawImage(r,0,0,e,c),a.toBlob((function(e){r.pause(),e||n(new Error("No blob")),t(e)}),"image/png")}catch(e){n(e)}else n("No context")})),r.play()}))})(n).then((function(n){return n?e(n):t(new Error("No blob"))})).catch((function(e){return t(e)}))})).catch((function(e){return t(e)}))}))]}))}))},_e=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}l((r=r.apply(e,t||[])).next())}))},we=function(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},xe=function(e,t){return _e(void 0,void 0,void 0,(function(){var r,a,o,c,i,l;return we(this,(function(u){switch(u.label){case 0:return[4,_e(void 0,void 0,void 0,(function(){return we(this,(function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,7,7))];case 1:return[2,e.sent().default]}}))}))];case 1:return r=u.sent(),a=function(e){var t=!!e&&document.querySelector(e)||document.documentElement||document.body.parentNode||document.body;return{x:t?t.scrollLeft:window.scrollX||window.pageXOffset||document.body.scrollLeft+(document.documentElement&&document.documentElement.scrollLeft||0),y:t?t.scrollTop:window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0)}}(e),o=a.x,c=a.y,[4,r(document.documentElement,{foreignObjectRendering:t,onclone:function(t){var n=t.querySelector(e)||t.body;n.scrollTop=c,n.scrollLeft=o}}).catch((function(){var e;return console.warn("\n            Feedback Widget >> An error occurred while capturing screenshot.\n            It is an known issue of a library (html2canvas) that is used in the Feedback widget.\n        "),r(document.body,{foreignObjectRendering:t,windowHeight:null===(e=document.querySelector("div.mx-page"))||void 0===e?void 0:e.clientHeight,scrollY:0})}))];case 2:return i=u.sent(),l=i.toDataURL(),i&&i.remove&&i.remove(),[2,l]}}))}))},Ee=function(e){var t=e.onSave,n=e.onCancel,r=e.onMinimize,o=e.scrollableAreaSelector,c=e.foreignObjectRendering,i=e.translation,l=Object(a.useState)(!1),u=l[0],s=l[1],d=Object(a.useRef)(null),f=Object(a.useRef)(null),m=Object(a.useRef)(null),p=function(){xe(o,c).then((function(e){t(e),s(!1)})).catch((function(e){console.error(e),s(!1),t("")}))},h=function(){u||(s(!0),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia?(r(),ke().then((function(e){return ue(e).then((function(e){s(!1),t(e)})).catch((function(e){console.error(e),s(!1),p()}))})).catch((function(e){console.error(e),s(!1),p()}))):p())},v=function(){se()&&new Promise((function(e,t){se()?navigator.permissions.query({name:"clipboard-read"}).then((function(n){switch(n.state){case"granted":e(B.granted);break;case"prompt":e(B.prompt);break;case"denied":e(B.denied);break;default:t(B.notSupported)}})):t(B.notSupported)})).then((function(e){e!==B.denied&&e!==B.notSupported&&new Promise((function(e,t){try{window.navigator.clipboard.read().then((function(t){for(var n=0,r=t;n<r.length;n++)for(var a=r[n],o=0,c=a.types;o<c.length;o++){var i=c[o];"image/png"===i&&a.getType(i).then((function(t){return ue(t).then((function(t){return e(t)}))}))}}))}catch(e){t(e)}})).then((function(e){t(e),s(!1)}))}))},g=function(e){var t,r;"s"!==e.key&&"S"!==e.key||h(),"v"===e.key&&(e.ctrlKey||e.metaKey)&&v(),"Escape"===e.key&&n(),"Tab"===e.key&&(e.target!==m.current||e.shiftKey?e.target===f.current&&e.shiftKey&&(null===(r=m.current)||void 0===r||r.focus()):(e.preventDefault(),null===(t=f.current)||void 0===t||t.focus()))};return Object(a.useEffect)((function(){var e,t,n=Array.from(null!==(t=null===(e=d.current)||void 0===e?void 0:e.querySelectorAll("[tabindex]"))&&void 0!==t?t:[]);f.current=n[0],m.current=n[n.length-1],f.current.focus()}),[f,m]),Object(a.useEffect)((function(){return document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[]),Object(a.createElement)("div",{ref:d,className:"mxfeedback-toolbar mxfeedback-toolbar--screenshot","data-html2canvas-ignore":"true"},Object(a.createElement)("div",{className:"mxfeedback-button-group mxfeedback-button-group--screenshot-container"},Object(a.createElement)("button",{tabIndex:0,type:"button","data-testid":"take-screenshot",onClick:h,title:"Click to take the screenshot",className:"btn mx-button btn-primary mxfeedback-button",autoFocus:!0},Object(a.createElement)(I,{className:"mxfeedback-button__take-screenshot-icon"}),u?"Taking screenshot ...":i.Take_screenshot),Object(a.createElement)("button",{tabIndex:0,type:"button",onClick:n,className:b()("btn mx-button btn-secondary","mxfeedback-button mxfeedback__btn-text")},i.Cancel)))};!function(e){e.FORM="FORM",e.SCREENSHOT="SCREENSHOT",e.ANNOTATE="ANNOTATE",e.RESULT="RESULT",e.FAILED="FAILED",e.NULL="NULL"}(de||(de={})),function(e){e.UPLOAD="UPLOAD",e.CAPTURE="CAPTURE",e.THIRD_PARTY="THIRD_PARTY",e.CLIPBOARD="CLIPBOARD"}(fe||(fe={}));var Oe=function(){return(Oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ye=function(e){var t=e.idTokenProviderMf,n=e.userProviderMf,r=e.allowScreenshot,o=e.scrollableAreaSelector,c=e.foreignObjectRendering,i=e.decryptedTokenValue,l=e.usernameAttribute,u=e.emailAttribute,s=e.userEntity,d=e.sprintrapp,f=e.feedbackServerLocation,m=e.translation,b=e.submitSuccessImgUrl,p=e.submitFailedImgUrl,h=e.stageName,v=e.setStage,g=e.setScreenshot,k=e.screenshot,_=e.onCancelAnnotationAndRemoveScreenshot,x=e.onUpdateScreenshot,E=e.setUserInfoMFResult,y=e.setShowLightbox,j=e.showLightbox,S=e.setError,N=e.updateFormData,T=e.formData,R=e.userInfoMFResult,C=e.error,L={FORM:Object(a.createElement)(be,{widgetSettings:{sprintrapp:d,feedbackServerLocation:f,allowScreenshot:r,idTokenProviderMf:t,userProviderMf:n,userEntity:s,usernameAttribute:l,emailAttribute:u,decryptedTokenValue:i},formData:T,screenshot:k,translation:m,takeScreenshot:function(){return v(de.SCREENSHOT)},updateFormData:N,onUpdateScreenshot:x,cancel:function(){return v(de.NULL)},succeeded:function(){return v(de.RESULT)},failed:function(e){S(e),v(de.FAILED)},onShowLightbox:function(){return y(!0)},showLightbox:j,userInfoMFResult:R,setUserInfoMFResult:function(e){return E(e)}}),SCREENSHOT:Object(a.createElement)(Ee,{onSave:x,onCancel:function(){return v(de.FORM)},onMinimize:function(){return v(de.NULL)},foreignObjectRendering:c,scrollableAreaSelector:o,translation:m}),ANNOTATE:Object(a.createElement)(w,{screenshot:k,onSave:function(e){g(e),v(de.FORM),N(Oe(Oe({},T),{screenshot:e,timestamp:(new Date).toString()}))},onCancel:_,translation:m}),RESULT:Object(a.createElement)(he,{widgetSettings:{submitSuccessImgUrl:b},onCloseResult:function(){return v(de.NULL)},translation:m}),FAILED:Object(a.createElement)(O,{widgetSettings:{submitFailedImgUrl:p},onCloseResult:function(){return v(de.NULL)},translation:m,error:C}),NULL:Object(a.createElement)(a.Fragment,null)};return Object(a.createElement)(a.Fragment,null,L[h])},je=function(e){var t=e.onCloseLightbox,n=e.screenshot,r=function(e){"Escape"===e.key&&(e.stopPropagation(),t())};return Object(a.useEffect)((function(){return document.addEventListener("keydown",r),function(){document.removeEventListener("keydown",r)}}),[]),Object(a.createElement)("div",{className:"mxfeedback-lightbox"},Object(a.createElement)("button",{className:"mxfeedback-close-button mxfeedback-close-button--white",id:"mxfeedback_feedback_lightbox_close_button",onClick:t,"aria-label":"Close button",autoFocus:!0},Object(a.createElement)(x,{className:"mxfeedback-close-button__icon"})),Object(a.createElement)("img",{src:n,className:"mxfeedback-lightbox__image"}))},Se=function(e){var t=e.onClick,n=e.className,r=e.tabIndex,o=e.translation;return Object(a.createElement)("button",{"data-html2canvas-ignore":"true","data-testid":"feedback",type:"button",onClick:t,className:b()("mxfeedback-button",n),tabIndex:r},o.Feedback)},Ne=function(e){var t,n=(t="mxfeedback-form-data__"+e,localStorage.getItem(t)),r={title:"",description:"",email:"",screenshot:"",timestamp:""},o=Object(a.useState)(n?JSON.parse(n):r),c=o[0],i=o[1],l=function(){if(!c.timestamp)return!1;var e=new Date,t=new Date(c.timestamp.toString()).getTime();return Math.round((e.getTime()-t)/1e3)>=2678400};return Object(a.useEffect)((function(){n&&JSON.parse(n).timestamp&&l()&&i(r)}),[n,c,i,l]),Object(a.useEffect)((function(){!function(e,t){var n="string"!=typeof t?JSON.stringify(t):t;localStorage.setItem(e,n)}("mxfeedback-form-data__"+e,c)}),[c]),[c,i]},Te=function(e){var t=e.className,n=e.tabIndex,r=e.idTokenProviderMf,o=e.userProviderMf,c=e.allowScreenshot,i=e.scrollableAreaSelector,l=e.foreignObjectRendering,u=e.decryptedTokenValue,s=e.usernameAttribute,d=e.emailAttribute,f=e.userEntity,m=e.sprintrapp,b=e.feedbackServerLocation,p=e.translation,h=e.submitSuccessImgUrl,v=e.submitFailedImgUrl,g=Object(a.useState)(de.NULL),k=g[0],_=g[1],w=Ne(m),x=w[0],E=w[1],O=Object(a.useState)(""),y=O[0],j=O[1],S=Object(a.useState)(""),N=S[0],T=S[1],R=Object(a.useState)(!1),C=R[0],L=R[1],F=Object(a.useState)(),I=F[0],A=F[1];Object(a.useEffect)((function(){if(k!==de.NULL){var e=document.querySelectorAll("[data-focus-capturing=modal]");return e.forEach((function(e){e.removeAttribute("data-focus-capturing")})),function(){e.forEach((function(e){e.setAttribute("data-focus-capturing","modal")}))}}}),[k]);return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(Se,{onClick:function(){return _(de.FORM)},className:"mxfeedback-start-button "+t,tabIndex:n,translation:p}),C&&Object(a.createElement)(je,{onCloseLightbox:function(){return L(!1)},screenshot:x.screenshot?x.screenshot:y}),(k===de.FORM||k===de.RESULT)&&Object(a.createElement)("div",{className:"mx-underlay mxfeedback-underlay","data-html2canvas-ignore":"true"}),Object(a.createElement)(ye,{idTokenProviderMf:r,userProviderMf:o,allowScreenshot:c,scrollableAreaSelector:i,foreignObjectRendering:l,sprintrapp:m,decryptedTokenValue:u,usernameAttribute:s,emailAttribute:d,userEntity:f,feedbackServerLocation:b,translation:p,submitSuccessImgUrl:h,submitFailedImgUrl:v,stageName:function(){switch(k){case de.FORM:return"FORM";case de.SCREENSHOT:return"SCREENSHOT";case de.ANNOTATE:return"ANNOTATE";case de.RESULT:return"RESULT";case de.FAILED:return"FAILED";case de.NULL:default:return"NULL"}}(),setStage:_,setScreenshot:j,screenshot:y,onCancelAnnotationAndRemoveScreenshot:function(){j(""),_(de.FORM)},onUpdateScreenshot:function(e){j(e),_(e?de.ANNOTATE:de.FORM)},setUserInfoMFResult:A,setShowLightbox:L,showLightbox:C,setError:T,updateFormData:E,userInfoMFResult:I,formData:x,error:N}))};function Re(e){var t=e.class,n=e.tabIndex,r=e.idTokenProviderMf,o=e.userProviderMf,c=e.allowScreenshot,i=e.scrollableAreaSelector,l=e.foreignObjectRendering,u=e.sprintrapp,s=e.submitSuccessImgUrl,d=e.submitFailedImgUrl,f=e.decryptedTokenValue,m=e.usernameAttribute,b=e.emailAttribute,p=e.userEntity,h=e.overrideFeedbackServerLocation,v=e.translation_Feedback,g=e.translation_Close,k=e.translation_Cancel,_=e.translation_Submit,w=e.translation_Email_Address,x=e.translation_Subject,E=e.translation_Description,O=e.translation_Attachment,y=e.translation_Done,j=e.translation_Enter_screenshot_mode,S=e.translation_Upload_from_computer,N=e.translation_Summarize_feedback_item,T=e.translation_Add_as_many_details_as_you_can,R=e.translation_Use_Screenshot_mode_to_take_a_snapshot,C=e.translation_Your_email_address_is_optional,L=e.translation_Include_a_screenshot_of_the_current_page,F=e.translation_Screenshots_have_been_disabled_for_the_feedback_mode,I=e.translation_Take_screenshot,A=e.translation_Error,U=e.translation_Sending_feedback,M=e.translation_Feedback_submitted,P=e.translation_Error_creating_a_screenshot,D=e.translation_Submit_Feedback_Error_Title,H=e.translation_Submit_Feedback_Error_Message,V={Feedback:null==v?void 0:v.value,Close:null==g?void 0:g.value,Cancel:null==k?void 0:k.value,Submit:null==_?void 0:_.value,Email_Address:null==w?void 0:w.value,Subject:null==x?void 0:x.value,Description:null==E?void 0:E.value,Attachment:null==O?void 0:O.value,Done:null==y?void 0:y.value,Enter_screenshot_mode:null==j?void 0:j.value,Upload_from_computer:null==S?void 0:S.value,Summarize_feedback_item:null==N?void 0:N.value,Add_as_many_details_as_you_can:null==T?void 0:T.value,Use_Screenshot_mode_to_take_a_snapshot:null==R?void 0:R.value,Your_email_address_is_optional:null==C?void 0:C.value,Include_a_screenshot_of_the_current_page:null==L?void 0:L.value,Screenshots_have_been_disabled_for_the_feedback_mode:null==F?void 0:F.value,Take_screenshot:null==I?void 0:I.value,Error:null==A?void 0:A.value,Sending_feedback:null==U?void 0:U.value,Feedback_submitted:null==M?void 0:M.value,Error_creating_a_screenshot:null==P?void 0:P.value,Submit_Feedback_Error_Title:null==D?void 0:D.value,Submit_Feedback_Error_Message:null==H?void 0:H.value},B=h||"https://feedback-api.mendix.com/";return Object(a.createElement)(Te,{className:t,tabIndex:n,idTokenProviderMf:r,userProviderMf:o,allowScreenshot:c,scrollableAreaSelector:i,foreignObjectRendering:l,sprintrapp:u,decryptedTokenValue:f,usernameAttribute:m,emailAttribute:b,userEntity:p,feedbackServerLocation:B,translation:V,submitSuccessImgUrl:s,submitFailedImgUrl:d})}}])}));