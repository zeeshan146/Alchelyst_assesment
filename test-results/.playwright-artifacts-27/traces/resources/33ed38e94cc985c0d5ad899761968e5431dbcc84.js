define(["exports","react","mendix/components/web/Icon"],(function(e,n,t){"use strict";var r,a={exports:{}};
/*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  */r=a,function(){var e={}.hasOwnProperty;function n(){for(var t=[],r=0;r<arguments.length;r++){var a=arguments[r];if(a){var o=typeof a;if("string"===o||"number"===o)t.push(a);else if(Array.isArray(a)){if(a.length){var d=n.apply(null,a);d&&t.push(d)}}else if("object"===o){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){t.push(a.toString());continue}for(var i in a)e.call(a,i)&&a[i]&&t.push(i)}}}return t.join(" ")}r.exports?(n.default=n,r.exports=n):window.classNames=n}();var o=a.exports;const d=n.createContext({level:0,informParentOfChildNodes:()=>null}),i=(e,t)=>{const{level:r,informParentOfChildNodes:a}=n.useContext(d);n.useEffect((()=>{r>0&&t()&&a(null==e?void 0:e.length)}),[e,r,a,t])};var l="widgets/com/mendix/widget/web/treenode/assets/72df3b1b0b37a958.svg";const c={Enter:"Enter"," ":"Space",Home:"Home",End:"End",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight"};const s=e=>n.useCallback((n=>{var t;if(function(e){return e.currentTarget===e.target}(n)&&(t=n.key,Object.hasOwn(c,t))){const t=e[c[n.key]];if(!t)return;n.stopPropagation(),n.preventDefault(),t(n)}}),[e]),u=()=>n.useCallback(((e,n,t)=>{if(e&&e instanceof Element){const r=e=>{if(e){const n=Array.from(e.querySelectorAll("li.widget-tree-node-branch")),t=Array.from(e.querySelectorAll(".widget-tree-node-body[aria-hidden=true]"));return n.filter((e=>!t.some((n=>n.contains(e)))))}return[]},a=Array.from(document.body.querySelectorAll(".widget-tree-node[role=tree]")).find((n=>n.contains(e)));if(!a)return;const o=r(a),d=o.length;if(0===d)return;const i=o.findIndex((n=>n.isSameNode(e)));switch(n){case"FIRST":o[0].focus();break;case"LAST":o[d-1].focus();break;case"PREVIOUS":{if("VERTICAL"===t){const n=r(document).filter((n=>{var t;return null===(t=n.lastElementChild)||void 0===t?void 0:t.contains(e)}));return void(n.length>0&&n[n.length-1].focus())}const n=i-1,a=Math.max(n,0);a!==i&&o[a].focus();break}case"NEXT":{if("VERTICAL"===t){const n=r(e.lastElementChild);return void(n.length>0&&n[0].focus())}const n=i+1,a=Math.min(n,d-1);a!==i&&o[a].focus();break}}}}),[]),h=(e,t,r,a,o)=>{const d=n.useMemo((()=>({Enter:e,Space:e,Home:e=>t(e.currentTarget,"FIRST"),End:e=>t(e.currentTarget,"LAST"),ArrowUp:e=>t(e.currentTarget,"PREVIOUS","HORIZONTAL"),ArrowDown:e=>t(e.currentTarget,"NEXT","HORIZONTAL"),ArrowRight:n=>{"COLLAPSED_WITH_CSS"===r||"COLLAPSED_WITH_JS"===r?e(n):("EXPANDED"===r||a)&&t(n.currentTarget,"NEXT","VERTICAL")},ArrowLeft:n=>{"COLLAPSED_WITH_CSS"===r||"COLLAPSED_WITH_JS"===r||a?t(n.currentTarget,"PREVIOUS","VERTICAL"):"EXPANDED"===r&&e(n)}})),[e,t,r,a]),i=s(d);return n.useCallback((e=>{if(!o(e))return i(e)}),[o,i])},m=e=>{let{className:t}=e;return n.createElement("svg",{className:t,"aria-hidden":!0,width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M1.64598 4.64601C1.69242 4.59945 1.7476 4.5625 1.80834 4.5373C1.86909 4.51209 1.93421 4.49911 1.99998 4.49911C2.06575 4.49911 2.13087 4.51209 2.19161 4.5373C2.25236 4.5625 2.30753 4.59945 2.35398 4.64601L7.99998 10.293L13.646 4.64601C13.6925 4.59952 13.7477 4.56264 13.8084 4.53749C13.8691 4.51233 13.9342 4.49938 14 4.49938C14.0657 4.49938 14.1308 4.51233 14.1916 4.53749C14.2523 4.56264 14.3075 4.59952 14.354 4.64601C14.4005 4.6925 14.4373 4.74769 14.4625 4.80842C14.4877 4.86916 14.5006 4.93426 14.5006 5.00001C14.5006 5.06575 14.4877 5.13085 14.4625 5.19159C14.4373 5.25233 14.4005 5.30752 14.354 5.35401L8.35398 11.354C8.30753 11.4006 8.25236 11.4375 8.19161 11.4627C8.13087 11.4879 8.06575 11.5009 7.99998 11.5009C7.93421 11.5009 7.86909 11.4879 7.80834 11.4627C7.7476 11.4375 7.69242 11.4006 7.64598 11.354L1.64598 5.35401C1.59942 5.30756 1.56247 5.25239 1.53727 5.19164C1.51206 5.1309 1.49908 5.06578 1.49908 5.00001C1.49908 4.93424 1.51206 4.86912 1.53727 4.80837C1.56247 4.74763 1.59942 4.69245 1.64598 4.64601V4.64601Z"}))},C=e=>{let{icon:r}=e,a=r;return r&&"image"!==r.type&&(a={...r,iconClass:o(r.iconClass,"widget-tree-node-branch-header-icon")}),n.createElement(t.Icon,{icon:a})},v=e=>({hasNestedTreeNode:n.useCallback((()=>{var n,t,r;return null===(r=null===(t=null===(n=e.current)||void 0===n?void 0:n.lastElementChild)||void 0===t?void 0:t.className.includes("widget-tree-node"))||void 0===r||r}),[])}),f=e=>{const t=n.useRef(),[r,a]=n.useState(!1);return{isAnimating:r,captureElementHeight:n.useCallback((()=>{var n,r;t.current=null!==(r=null===(n=e.current)||void 0===n?void 0:n.getBoundingClientRect().height)&&void 0!==r?r:0}),[]),animateTreeNodeContent:n.useCallback((()=>{if(e.current&&void 0!==t.current&&!Number.isNaN(t.current)){const n=e.current.getBoundingClientRect().height;if(n-t.current!=0){a(!0),e.current.style.height="".concat(t.current,"px");const r=setTimeout((()=>{e.current.style.height="".concat(n,"px"),t.current=n}),1);return()=>clearTimeout(r)}}}),[]),cleanupAnimation:n.useCallback((()=>{var n;a(!1),null===(n=e.current)||void 0===n||n.style.removeProperty("height")}),[])}};function g(e){let{class:t,items:r,style:a,isUserDefinedLeafNode:c,showCustomIcon:s,startExpanded:h,iconPlacement:v,expandedIcon:f,collapsedIcon:g,tabIndex:p,animateIcon:b,animateTreeNodeContent:A,openNodeOn:I}=e;const{level:w}=n.useContext(d),S=n.useCallback(((e,t)=>{if("LOADING"===e)return n.createElement("img",{src:l,className:"widget-tree-node-loading-spinner",alt:"","aria-hidden":!0});const r="EXPANDED"===e;return s?n.createElement(C,{icon:r?f:g}):n.createElement(m,{className:o("widget-tree-node-branch-header-icon",{"widget-tree-node-branch-header-icon-animated":b,"widget-tree-node-branch-header-icon-collapsed-left":!r&&"left"===t,"widget-tree-node-branch-header-icon-collapsed-right":!r&&"right"===t})})}),[g,f,s,b]),[L,T]=n.useState(null),D=n.useCallback((e=>{e&&T(e)}),[]),y=n.useCallback((()=>{var e,n;return null!==(n=null===(e=null==L?void 0:L.parentElement)||void 0===e?void 0:e.className.includes(E.bodyClassName))&&void 0!==n&&n}),[L]);i(r,y);const O=u();return r?n.createElement("ul",{className:o("widget-tree-node",t),style:a,ref:D,"data-focusindex":p||0,role:0===w?"tree":"group"},r.map((e=>{let{id:t,headerContent:r,bodyContent:a}=e;return n.createElement(N,{key:t,id:t,headerContent:r,isUserDefinedLeafNode:c,startExpanded:h,iconPlacement:v,renderHeaderIcon:S,changeFocus:O,animateTreeNodeContent:A,openNodeOn:I},a)}))):null}const E={bodyClassName:"widget-tree-node-body",getHeaderId:e=>"".concat(e,"TreeNodeBranchHeader"),getBodyId:e=>"".concat(e,"TreeNodeBranchBody")};function N(e){const{level:t}=n.useContext(d),[r,a]=n.useState(e.startExpanded?"EXPANDED":"COLLAPSED_WITH_JS"),[i,l]=n.useState(e.isUserDefinedLeafNode||!e.children),c="headerClick"===e.openNodeOn,s="iconClick"===e.openNodeOn;n.useEffect((()=>{l(e.isUserDefinedLeafNode||!e.children)}),[e.children]);const u=n.useCallback((e=>{void 0!==e&&(a((e=>"LOADING"===e?"EXPANDED":e)),l((n=>0===e&&!n||!(e>0&&n)&&n)))}),[]),m=n.useRef(null),C=n.useRef(null),{hasNestedTreeNode:g}=v(m),{isAnimating:N,captureElementHeight:p,animateTreeNodeContent:b,cleanupAnimation:A}=f(m);n.useLayoutEffect((()=>{if(e.animateTreeNodeContent&&"LOADING"!==r){const e=b();if(e)return e}}),[b,e.animateTreeNodeContent,r]);const I=n.useCallback((e=>{var n,t,r,a,o;const d=e.target;return!(null===(n=C.current)||void 0===n?void 0:n.isSameNode(d))&&!(null===(r=null===(t=C.current)||void 0===t?void 0:t.firstElementChild)||void 0===r?void 0:r.contains(d))&&!(null===(o=null===(a=C.current)||void 0===a?void 0:a.lastElementChild)||void 0===o?void 0:o.isSameNode(d))}),[]);n.useEffect((()=>{"LOADING"===r&&(g()||a("EXPANDED"))}),[g,r]);const w=n.useCallback((e=>{I(e)||i||(p(),a((e=>"LOADING"===e?e:"COLLAPSED_WITH_JS"===e?"LOADING":"COLLAPSED_WITH_CSS"===e?"EXPANDED":"COLLAPSED_WITH_CSS")))}),[i,I,p]),S={"aria-expanded":"EXPANDED"===r,role:"treeitem",tabIndex:0};const L=h(w,e.changeFocus,r,i,I),T=s?w:void 0,D=c?w:void 0;return n.createElement("li",{className:"widget-tree-node-branch",onKeyDown:L,ref:C,...S},n.createElement("span",{className:o("widget-tree-node-branch-header",{"widget-tree-node-branch-header-clickable":!i&&c,"widget-tree-node-branch-header-reversed":"left"===e.iconPlacement}),id:E.getHeaderId(e.id),onClick:D},n.createElement("span",{className:"widget-tree-node-branch-header-value"},e.headerContent),!i&&"no"!==e.iconPlacement&&n.createElement("span",{className:o("widget-tree-node-branch-header-icon-container",{"widget-tree-node-branch-header-clickable":!i&&s}),onClick:T},e.renderHeaderIcon(r,e.iconPlacement))),(!i&&"COLLAPSED_WITH_JS"!==r||N)&&n.createElement(d.Provider,{value:{level:t+1,informParentOfChildNodes:u}},n.createElement("div",{className:o(E.bodyClassName,{"widget-tree-node-branch-hidden":"COLLAPSED_WITH_CSS"===r&&!N,"widget-tree-node-branch-loading":"LOADING"===r}),id:E.getBodyId(e.id),"aria-hidden":"EXPANDED"!==r,ref:m,onTransitionEnd:A},e.children)))}e.TreeNode=function(e){var t,r,a,o;const d="available"===e.datasource.status?null!==(r=null===(t=e.datasource.items)||void 0===t?void 0:t.map((n=>function(e,n){var t,r,a;return{id:e.id,headerContent:"text"===n.headerType?null===(t=n.headerCaption)||void 0===t?void 0:t.get(e).value:null===(r=n.headerContent)||void 0===r?void 0:r.get(e),bodyContent:null===(a=n.children)||void 0===a?void 0:a.get(e)}}(n,e))))&&void 0!==r?r:[]:null,i="available"===(null===(a=e.expandedIcon)||void 0===a?void 0:a.status)?e.expandedIcon.value:void 0,l="available"===(null===(o=e.collapsedIcon)||void 0===o?void 0:o.status)?e.collapsedIcon.value:void 0;return n.createElement(g,{class:e.class,style:e.style,items:d,isUserDefinedLeafNode:!e.hasChildren,startExpanded:e.startExpanded,showCustomIcon:Boolean(e.expandedIcon)||Boolean(e.collapsedIcon),iconPlacement:e.showIcon,expandedIcon:i,collapsedIcon:l,tabIndex:e.tabIndex,animateIcon:e.animate&&e.animateIcon,animateTreeNodeContent:e.animate,openNodeOn:e.openNodeOn})},Object.defineProperty(e,"__esModule",{value:!0})}));
